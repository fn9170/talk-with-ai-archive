# YOLO v8 完全入门教程 - 从零开始

## 📖 目录
1. [什么是YOLO v8](#什么是yolo-v8)
2. [环境准备](#环境准备)
3. [安装YOLO v8](#安装yolo-v8)
4. [第一个例子：图像目标检测](#第一个例子图像目标检测)
5. [训练自己的模型](#训练自己的模型)
6. [实际应用案例](#实际应用案例)
7. [常见问题解决](#常见问题解决)

## 什么是YOLO v8

YOLO (You Only Look Once) v8 是目前最先进的实时目标检测算法之一。它可以：
- 🔍 识别图片中的物体（人、车、动物等）
- 📍 标出物体的位置（用方框框出来）
- ⚡ 处理速度非常快，可以实时处理视频
- 🎯 准确率很高

**通俗理解**：就像给电脑一双"眼睛"，让它能像人一样识别看到的东西。

## 环境准备

### 1. 安装Python
确保你的电脑有Python 3.8或更高版本。

**检查Python版本：**
```bash
python --version
```

如果没有Python，去 [python.org](https://python.org) 下载安装。

### 2. 创建虚拟环境（推荐）
```bash
# 创建虚拟环境
python -m venv yolo_env

# 激活虚拟环境
# Windows:
yolo_env\Scripts\activate
# Mac/Linux:
source yolo_env/bin/activate
```

**为什么要用虚拟环境？**
就像给每个项目准备一个独立的工具箱，避免不同项目的工具互相冲突。

## 安装YOLO v8

### 方法一：使用pip安装（推荐新手）
```bash
pip install ultralytics
```

### 方法二：安装额外依赖（如果需要更多功能）
```bash
pip install ultralytics[export]  # 支持模型导出
pip install ultralytics[dev]     # 开发者工具
```

### 验证安装
```bash
yolo --help
```
如果看到帮助信息，说明安装成功！

## 第一个例子：图像目标检测

### 1. 准备一张图片
找一张包含人、车、动物等常见物体的图片，保存为 `test.jpg`

### 2. 创建第一个Python脚本
创建文件 `my_first_yolo.py`：

```python
from ultralytics import YOLO

# 1. 加载预训练模型
model = YOLO('yolov8n.pt')  # n表示nano，最小最快的版本

# 2. 对图片进行检测
results = model('test.jpg')

# 3. 显示结果
results[0].show()

# 4. 保存结果图片
results[0].save('result.jpg')

print("检测完成！结果保存在 result.jpg")
```

### 3. 运行代码
```bash
python my_first_yolo.py
```

**第一次运行会自动下载模型文件（约6MB），需要等待一下。**

### 4. 理解结果
运行后你会看到：
- 原图上画出了方框
- 每个方框标注了物体类别和置信度
- 比如：`person 0.85` 表示85%确信这是一个人

## 训练自己的模型

### 1. 准备数据集

**数据集结构：**
```
dataset/
├── images/
│   ├── train/
│   │   ├── img1.jpg
│   │   └── img2.jpg
│   └── val/
│       ├── img3.jpg
│       └── img4.jpg
└── labels/
    ├── train/
    │   ├── img1.txt
    │   └── img2.txt
    └── val/
        ├── img3.txt
        └── img4.txt
```

**标签格式（.txt文件）：**
```
# 每行格式：类别ID x_center y_center width height
0 0.5 0.5 0.3 0.4
1 0.2 0.3 0.1 0.2
```
所有坐标都是相对于图片大小的比例（0-1之间）。

### 2. 创建配置文件
创建 `config.yaml`：

```yaml
# 数据集路径
path: ./dataset
train: images/train
val: images/val

# 类别数量
nc: 2

# 类别名称
names:
  0: cat
  1: dog
```

### 3. 开始训练
```python
from ultralytics import YOLO

# 加载模型
model = YOLO('yolov8n.pt')

# 开始训练
model.train(
    data='config.yaml',    # 配置文件
    epochs=100,            # 训练轮数
    imgsz=640,            # 图片大小
    batch=16,             # 批次大小
    save=True             # 保存最佳模型
)
```

### 4. 使用训练好的模型
```python
# 加载你训练的模型
model = YOLO('runs/detect/train/weights/best.pt')

# 预测
results = model('new_image.jpg')
results[0].show()
```

## 实际应用案例

### 案例1：实时摄像头检测
```python
from ultralytics import YOLO
import cv2

model = YOLO('yolov8n.pt')

# 打开摄像头
cap = cv2.VideoCapture(0)

while True:
    ret, frame = cap.read()
    if not ret:
        break
    
    # 检测
    results = model(frame)
    
    # 在图像上绘制结果
    annotated_frame = results[0].plot()
    
    # 显示
    cv2.imshow('YOLO Detection', annotated_frame)
    
    # 按q退出
    if cv2.waitKey(1) & 0xFF == ord('q'):
        break

cap.release()
cv2.destroyAllWindows()
```

### 案例2：批量处理图片
```python
from ultralytics import YOLO
import os

model = YOLO('yolov8n.pt')

# 批量处理文件夹中的图片
input_folder = 'input_images'
output_folder = 'output_images'

# 创建输出文件夹
os.makedirs(output_folder, exist_ok=True)

# 处理每张图片
for filename in os.listdir(input_folder):
    if filename.lower().endswith(('.jpg', '.jpeg', '.png')):
        input_path = os.path.join(input_folder, filename)
        
        # 检测
        results = model(input_path)
        
        # 保存结果
        output_path = os.path.join(output_folder, f'detected_{filename}')
        results[0].save(output_path)
        
        print(f'处理完成: {filename}')
```

### 案例3：只检测特定物体
```python
from ultralytics import YOLO

model = YOLO('yolov8n.pt')

# 只检测人和车（类别ID：0=person, 2=car）
results = model('image.jpg', classes=[0, 2])

# 设置置信度阈值
results = model('image.jpg', conf=0.5)  # 只显示置信度>50%的检测

results[0].show()
```

## 不同模型大小对比

| 模型 | 大小 | 速度 | 精度 | 适用场景 |
|------|------|------|------|----------|
| yolov8n | 6MB | 最快 | 较低 | 实时应用、资源限制 |
| yolov8s | 22MB | 快 | 中等 | 平衡应用 |
| yolov8m | 52MB | 中等 | 较高 | 精度要求较高 |
| yolov8l | 88MB | 慢 | 高 | 高精度需求 |
| yolov8x | 136MB | 最慢 | 最高 | 最高精度需求 |

**选择建议：**
- 初学者：用 `yolov8n`
- 实际项目：根据需求选择 `yolov8s` 或 `yolov8m`

## 常见问题解决

### Q1: 安装时遇到错误
```bash
# 升级pip
pip install --upgrade pip

# 如果网络慢，使用国内源
pip install ultralytics -i https://pypi.tuna.tsinghua.edu.cn/simple/
```

### Q2: 模型下载慢
第一次运行会下载模型文件，如果太慢：
1. 使用VPN
2. 或手动下载模型文件到 `~/.cache/torch/hub/ultralytics_yolov8_main/`

### Q3: 内存不够
```python
# 减小批次大小
model.train(batch=8)  # 默认是16

# 使用更小的图片尺寸
model.train(imgsz=416)  # 默认是640
```

### Q4: GPU支持
```python
import torch
print(f"CUDA available: {torch.cuda.is_available()}")

# 强制使用CPU
model = YOLO('yolov8n.pt')
model.to('cpu')
```

### Q5: 检测结果不理想
1. **调整置信度阈值**：
   ```python
   results = model('image.jpg', conf=0.25)  # 降低阈值显示更多检测
   ```

2. **使用更大的模型**：
   ```python
   model = YOLO('yolov8m.pt')  # 使用中等大小模型
   ```

3. **图片预处理**：
   ```python
   # 调整图片大小
   results = model('image.jpg', imgsz=1280)  # 更大的输入尺寸
   ```

## 进阶学习建议

### 1. 学习路径
1. ✅ 先掌握基本使用（本教程）
2. 📚 学习数据标注工具（如LabelImg）
3. 🎯 尝试训练自己的数据集
4. 🚀 学习模型优化和部署

### 2. 有用的资源
- [官方文档](https://docs.ultralytics.com/)
- [GitHub仓库](https://github.com/ultralytics/ultralytics)
- [示例代码](https://github.com/ultralytics/ultralytics/tree/main/examples)

### 3. 实践项目建议
1. **宠物识别器**：训练识别猫狗
2. **口罩检测**：检测是否佩戴口罩
3. **交通监控**：检测车辆和行人
4. **商品识别**：识别不同商品

## 总结

YOLO v8 是一个强大而易用的目标检测工具。通过这个教程，你已经学会了：

✅ 安装和设置环境  
✅ 使用预训练模型进行检测  
✅ 训练自己的模型  
✅ 实际应用案例  
✅ 常见问题解决  

**下一步建议**：
1. 找一些图片试试检测效果
2. 尝试用摄像头做实时检测
3. 收集数据训练自己的模型

记住：**实践是最好的老师**！多动手试试，遇到问题就查文档或搜索解决方案。

---

*教程创建时间：2025-06-25*  
*适用于：YOLO v8 初学者* 